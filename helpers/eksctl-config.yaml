kind: ClusterConfig
apiVersion: eksctl.io/v1alpha5
metadata:
  name: demo-DEV
  version: "1.21"
  region: eu-west-2
availabilityZones:
  - us-east-1a
  - us-east-1b
  - us-east-1c
iam:
  withOIDC: true
  serviceAccounts:
    - metadata:
        name: cluster-autoscaler
        namespace: kube-system
      wellKnownPolicies:
        autoScaler: true
      roleName: demo-DEV-autoscaler-role
    - metadata:
        name: aws-load-balancer-controller
        namespace: aws-system
      wellKnownPolicies:
        awsLoadBalancerController: true
      roleName: demo-DEV-lb-controller-role
    - metadata:
        name: aws-cloudwatch-agent
        namespace: aws-system
      attachPolicyARNs:
        - arn:aws:iam::aws:policy/CloudWatchAgentServerPolicy
      roleName: demo-DEV-cloudwatch-metrics
    - metadata:
        name: aws-fluent-bit
        namespace: aws-system
      attachPolicyARNs:
        - arn:aws:iam::aws:policy/CloudWatchAgentServerPolicy
      roleName: demo-DEV-fluent-bit
addons:
  - name: vpc-cni
    version: latest
  - name: kube-proxy
    version: latest
  - name: coredns
    version: latest
gitops:
  flux-demo-DEV:
    gitProvider: github
    flags:
      owner: delivery-k8s-maksystem
      repository: eks-fluxcd-bootstrap
      branch: demo-DEV
      path: ./clusters/demo-DEV/
      namespace: flux-system-demo-DEV
  flux-demo-VAL:
    gitProvider: github
    flags:
      owner: delivery-k8s-maksystem
      repository: eks-fluxcd-bootstrap
      branch: demo-VAL
      path: ./clusters/demo-VAL/
      namespace: flux-system-demo-VAL
  flux-demo-PROD:
    gitProvider: github
    flags:
      owner: delivery-k8s-maksystem
      repository: eks-fluxcd-bootstrap
      branch: demo-PROD
      path: ./clusters/demo-PROD/
      namespace: flux-system-demo-PROD
managedNodeGroups:
  - name: demo-DEV-amd64-workers
    instanceType: m5.large
    desiredCapacity: 3
    minSize: 2
    maxSize: 5
    privateNetworking: true

